\chaptr{6 Optimalitätsbedingungen für nichtlineare Optimierungsprobleme}

\msection{6.1 Allgemeine Problembeschreibung}

\[ \min_{x \in \R^n} f(x) \quad f \in C^2(\R^n, \R), \text{ "`Zielfunktion"' } (6.1) \]
\[ g(x) = 0 \quad g \in C^2(\R^n, \R^{m_1}), \text{ "`Gleichungsbedingungen"'} \]
\[ h(x) \leq 0 \quad h \in C^2(\R^n, \R^{m_2}), \text{ "`Ungleichungsbedingung"'} \]

Wir betrachten endlichdimensionale, kontinuierliche, glatte Probleme.

Wir unterscheiden

\bitm
\item unbeschränkte 
\item gleichungsbeschränkte
\item Gleichungs- und Ungleichungs-beschränkte Probleme
\eitm

\msubsection{Definition 6.1}

Ein Punkt $c \in \R^n$ heißt zulässiger Punkt des Problems (6.1), wenn er alle Nebenbedingungen erfüllt: $g(x) = 0$, $h(x \leq 0)$.

\msubsection{Definition 6.2}

Ein Punkt $x^* \in \R^n$ heißt lokales Minimum von (6.1) wenn er zulässig ist und wenn ein Zielfunktionswert kleiner oder gleich den Zielfunktionswerten aller zulässigen Punkte in einer Umgebung von $x^*$ ist.

\[ x^* \text{ lokales Minimum } \LRA g(x^*) = 0 \wedge h(x^*) \leq 0 \wedge \exists \text{ Umgebung } U \text{ von } x^*: \forall x \in U \text{ mit } g(x) = 0, h(x) \leq 0 \text{ ist } f(x^*) \leq f(x) (6.2) \]

\msubsection{Definition 6.3}

Ein Punkt heißt globales Minimum, wenn er zulässig ist und sein Zielfunktionswert kleiner gleich den Zielfunktionswerten aller anderen zulässigen Punkte.

\[ x^* \text{ globales Minimum } \LRA g(x^*) = 0 \wedge h(x^*) \leq 0: \forall x \text{ mit } g(x) = 0, h(x) \leq 0 \text{ ist } f(x^*) \leq f(x) (6.3) \]

Die Bestimmung von globalen Optima heißt globale Optimierung. Wir beschränken uns in dieser Vorlesung auf die Berechnung lokaler Optima.

\msection{Definition 6.4}

Ein Minimum $x^*$ heißt strikt, wenn

\[ f(x^*) < f(x) \forall x \in U, x \neq x^*, x \text{ zulässig } (\text{lokal}) \]
\[ f(x^*) < f(x) \forall x \text{ zulässig } (\text{global}) \]

\msection{6.2 Optimalitätsbedingung im eindimensionalen Fall}

Lemma 6.5: Sei $f: (a,b) \subset \R \to \R$, $f \in C^2$. Dann gilt:

\bitm
\item Wenn $x^* \in (a,b)$ ein lokales Minimum von $f$ ist, ist $f'(x) = 0$ (notwendige Bedingung erster Ordnung) und $f''(x^*) \geq 0$ (notwendige Bedingung 2ter Ordnung)
\item Wenn $f'(x^*) = 0$ und $f''(x^*) > 0$, dann ist $x^*$ ein striktes lokales Minimum von $f$ (hinreichende Bedingung 2ter Ordnung).
\eitm

Beweis: Analysis 1

\msection{6.3 Unbeschränkter Fall}

Satz 6.6 (Notwendige Bedingungen erster und zweiter Ordnung)

Sei $f : \R^n \to \R$, $f \in C^2$. $x^*$ sei ein lokales Minimum von $f$.

\bitm
\item a) $\nabla f(x^*) = 0$ (6.4)
\item b) $\nabla^2 f(x^*) = 0$ (6.5)
\eitm

Beweis: Zurückführung auf den eindimensionalen Fall entlang beliebiger Kurven von Konkurrenten.

Sei $p \in \R^n$ beliebig. Die Funktion $\tilde f(t) := f(x^*+tp)$, $t\in \R$ hat in $x^*$ bzw. $t=0$ ein lokales Minimum. Also gilt nach Lemma 6.5 (eindimensionaler Fall):

\bitm
\item a) $0 = \tilde f'(0) = \frac{\partial}{\partial t} f(x^* + tp)|_{t=0} = f'(x^*) p = \nabla f(x^*)^T p \RA \nabla f(x^*) = 0$, da $p$ beliebig.
\item b) $0 \leq \tilde f''(0) = \frac{\partial^2}{\partial t^2} f(x^* + tp)|_{t=0} = p^T \nabla^2 f(x^*) p \RA \nabla^2 f(x^*)$ ist positiv semidefinit.
\eitm

\msubsection{Satz 6.7 (Heinreichende Bedingung)}

% ... Terme höherer Ordnung irgendwie wegdiskutieren
Sei $f: \R^n \to \R$, $f \in C^2$. Sei $x^* \in \R^n$ mit $\nabla f(x^*) = 0$ und $\nabla^2 f(x^*)$ positiv definit (6.6). Dann gilt: $x^*$ ist ein striktes lokales Minimum von $f$.

Beweis: Es existiert eine Umgebung $U$ von $x^*$ so dass die Hesse-Matrix $\nabla^2 f$ positiv definit für alle $x$ in der Umgebung $U$, da die Eigenwerte stetig von den Einträgen abhängen und die Einträge stetig von $x$ abhängen.
Entwicklung in eine Taylorreihe um $x^*$:

\begin{align*}
f(x) &= f(x^*) + \nabla f(x^*)^T (x-x^*) + \underbrace{\frac 12 (x-x^*)^T \nabla^2 f(\tilde x) (x-x^*)}_{>0} \text{ mit } \tilde x \in U \\
i\RA f(x) &> f(x^*) \\
\end{align*}

\msubsection{6.4 Gleichungsbeschränkter Fall}

Notation: $f: \R^n \to \R$, Ableitung $\frac{\partial f}{\partial x}f(x) = f'(x) = f_x(x) \in \R^n$ Zeilenvektor. Gradient: $\nabla f(x) = f_x(x)^T \in \R^n$ Spaltenvektor. Hessematrix $\nabla^2 f(x) = f_{xx}(x) = \frac{\partial}{\partial x} \nabla f(x) = \nabla \frac{\partial}{\partial x} f(x) \in \R^{n\times n}$ (symmetrische Matrix nach Satz von Schwarz).

$g: \R^n \to \R^m$, $n \leq m$, $\frac{\partial g}{\partial x} (x) = g_x(x) \in \R^{m\times n}$, $\nabla g(x) = g_x(x)^T \in \R^{n\times m}$. Menge aller zulässigen Punkte: $S := \{x : g(x) = 0\}$

\msubsection{Definition 6.8}

Ein Punkt $x^*$ heißt regulär, wenn er die Constraint Qualification (CQ) erfüllt: $\Rg(g_x(x^*)) = m$ (6.7).

\msubsection{Definition 6.9: Tangentialebene}

Die Menge $T(x^*) = \{ p : g_x(x^*) p = 0 \}$ (6.8) heißt Tangentialebene an $S$ in $x^* \in S$.

Laufe entlang der zulässigen Menge $S=\{x:g(x)=0\}$. Entweder wir schneiden die Höhenlinien von $f$, z.\,B. in $\hat x$. Dann erhöht oder erniedrigt ein kleiner Schritt den Zielfunktionswert, $\hat x$ ist also kein Optimum. Oder wir berühren eine Höhenlinie von $f$ tangential, hier in $x^*$. Dann kann $x^*$ ein Optimum sein.

Im lokalen Minimum gilt: Die Tangentialebene von $S$ und die Höhenlinien von $f$ sind parallel, also sind die Normalenvektoren parallel:

\[ -\nabla f(x^*) = \lambda \nabla g(x^*), \quad \lambda \in \R \]

Verallgemeinerung für $m$ Nebenbedingungen:

\begin{align*}
&-\nabla f(x^*) \text{ ist eine Linearbkombination der Gradienten der Nebenbedingungen:} \\
\exists \lambda \in \R^m : &-\nabla f(x^*) = \sum\limits_{i=1}^m \lambda_i \nabla g_i(x^*) = \nabla g(x^*) \lambda \quad (6.9) \\
\end{align*}

\msubsection{Definition 6.10}

Die Funktion $L: \R^n \times \R^m: (x,\lambda) \mapsto L(x,\lambda) := f(x) + \lambda^T g(x)$ (6.10) heißt Lagrangefunktion (Lagrangian) des beschränkten Optimierungsproblems $\min f(x) $ s.\,t. $g(x)=0$.

\msubsubsection{Bemerkung 6.11}

Gradient der Lagrangsfunktion:

\begin{align*}
\nabla_x L(x,\lambda) &= \nabla f(x) + \nabla g(x) \lambda \quad (6.11) \\
\nabla_\lambda L(x,\lambda) &= g(x) \\
\end{align*}

Hessematrix der Lagrangefunktion:

\[ \nabla^2 L(x,\lambda) = \bpm \nabla_{xx}^2 L(x,\lambda) & \nabla g(x) \\ \nabla g(x)^T & 0 \epm \quad (6.12) \]
\[ \text{mit } \nabla{xx}^2 L(x,\lambda) = \nabla_{xx}^2 f(x) + \underbrace{\nabla_{xx}^2 g(x) \lambda}_{\in \R^{n\times n}} \]

\msubsection{Satz 6.12 (Notwendige Bedingung erster Ordnung}

Betrachte das Problem $\min f(x)$ s.\,t. $g(x)=0$ mit $f\in C^2(\R^n,\R)$, $g \in C^2(\R^m, \R^n)$, $m \leq n$. Sei $x^*$ ein lokales Minimum, $x^*$ regulär. Dann existiert $\lambda \in \R^m$, so dass $\nabla_x L(x^*,\lambda) = \nabla f(x^*) + \nabla g(x^*) \lambda = 0$ und $\nabla_\lambda L(x^*, \lambda) = g(x^*) ) 9$ (6.13) bzw. $\nabla L(x.\lambda)=0$.

Beweis:

$x^*$ regulär $\RA g_x(x^*) = 0 \RA $ man kann $x$ zerlegen in $x = (y,z)$ so dass $g_y(x^*) \in \R^{m\times m}$ invertierbar. Führe die Fragestellung zurück auf den eindimensionalen Fall entlang Kurven von zulässigen Konkurrenzpunkten.

\begin{align*}
x &= \phi(t) \text{ mit } \phi(0) = x^*, \phi(1) = \ov x \neq x^* \text{ zulässiger Punkt} \\
\text{und } g(\phi(t)) &\equiv 0 \\
\phi(t) &= \bpm y(t) \\ z(t) \epm = \bpm y(t) \\ z^* + t(\ov z - z^*) \epm \\
0 &= \l. \frac{\partial}{\partial t} g(\phi(t))\r|_{t=0} = g_y(x^*) y'(0) + g_z(x^*) z'(x^*) \\
\RA \phi'(0) &= \bpm y'(o) \\ z'(0) \epm = \bpm -g_y(x^*)^{-1} g_z(x^*) \\ I \epm h \\
\end{align*}

$f(\phi(t))$ ist minimal in $t=0$. Daher ist $0 = \frac{\partial}{\partial t} f(\phi(t))|_{t=0} = f_x(x^*) \phi'(0) = (-f_y(x^*) g(x^*)^{-1} g_z(x^*) + f_z(x^*))h$.

Definiere $\lambda^T := -f_y(x^*)g_y(x^*)^{-1}$. Dann ist $f_y(x^*) + \lambda^T g_y(x^*) = 0$. $f_z(x^*) + \lambda^T g_z(x^*) = 0$ also ist $f_x(x^*) + \lambda^T g_x(x^*) = 0$ d.\,h. $\nabla L(x,\lambda)=0$.

$\nabla_\lambda L(x^*,\lambda) = g(x^*) = 0$, da $x^*$ zulässig.

\msubsection{Bemerkung 6.13}

Die Vektoren aus der Tangentialebene $T(x^*) = \ker g_x(x^*)$ haben die Gestalt:

\begin{align*}
p &= \bpm p_y \\ p_z \epm = \bpm -g_y(x^*)^{-1} g_z(x^*) \\ I \epm p_z \text{ denn } \\
0 &= g_x(x^*)p = g_y(x^*)p_y + g_z(x^*) p_z \\
\end{align*}

Alle zulässigen Kurven laufen also in der Tangentialebene in $x^*$ ein:

\begin{align*}
\phi(o) &= x^* \\
\phi'(0) &\in T(x^*)
\end{align*}

Die Spalten von

\[ \bpm -g_y(x^*)^{-1} g_z(x^*) \\ I \epm \]

bilden eine Basis von $T(x^*)$.

\msection{Satz 6.12}

$x^*$ optimal $\RA \nabla L(x^*,\lambda) = 0$ für ein $\lambda \in \R^m$.

\begin{align*}
0 &= \nabla_x L(x^*,\lambda) = \nabla f(x^*) + \nabla g(x^*) \lambda \\
0 &= \nabla_\lambda L(x^*, \lambda) = g(x^*) \\
\end{align*}

\msection{Definition 6.14}

Die notwendigen Bedingungen (6.13) heißen KKT-Bedingungen. Reguläre Punkte $x^* \in \R^n$, für die es $\lambda \in \R^n$ gibt, so dass $\nabla_{x,\lambda} L(x^*, \lambda) = 0$ heißen KKT-Punkte bzw. stationäre Punkte.

\msection{Bemerkung 6.15}

Stationäre Punkte können Minima aber auch Maxima oder Sattelpunkte sein.

\msection{Satz 6.16 (Notwendige Bedingungen zweiter Ordnung}

Seien die Voraussetzungen wie in Satz 6.12. Sei $x^*$ ein lokales Minimum, $x^*$ regulär. Dann ist die Hessematrix von $L$ nach $x$ und $x$ positid semidefinit auf $T(x^*) = \ker g_x(x^*)$, d.\,h.

\[ p^T \nabla_{xx}^2 L(x^*, \lambda) p \geq 0 \quad \forall p \in T(x^*) \]

Beweis: Weiter im Beweis von 6.12:

Es gilt:

\begin{align*}
0 &\leq \l. \frac{\partial^2}{\partial t^2} f(\phi(t)) \r|_{t=0} = \l. \frac{\partial}{\partial t} f_x(\phi(t)) \phi'(t) \r|_{t=0} \\
&= \l. \underbrace{ \phi'(t)^T f_xx(\phi(t)) \phi'(t)}_{\text{Krümmung von } f} \r|_{t=0} + \l. \underbrace{f_x(\phi(t)) \phi'(t)}_{\text{Krümmung von } \phi} \r|_{t=0} \\
\end{align*}

Außerdem gilt:

\begin{align*}
\frac{\partial^2}{\partial t^2} \lambda^T g(\phi(t)) &= 0 \text{ da } g(\phi(t)) \equiv 0 \\
\frac{\partial^2}{\partial t^2} \lambda^T g(\phi(t)) &= \phi'(t)^T (\lambda^T g_{xx} (\phi(t))) \phi'(t) + \lambda^T g_x(\phi(t)) \phi''(t) \\
\text{Also } 0 & \leq \phi'(0)^T (f_{xx} (x^*)^T + \lambda^T g_{xx}(x^*)) \phi'(0) + \underbrace{(f_{xx}(x^*) + \lambda^T g_x(x^*))}_{L_{x} (x^*, \lambda) = 0} \phi''(t) \\
&= \phi'(0)^T \nabla_{xx}^2 L(x^*, \lambda) \phi'(0) \\
\end{align*}

$\phi'(0)$ ist irgendein Vektor aus $T(x^*) \RA \nabla_{xx}^2 L(x^*, \lambda)$ ist positiv semidefinit auf $T(x^*)$.

\msection{Satz 6.17 (Hinreichende Bedingung)}

Seien die Voraussetzungen wie in Satz 6.12, aber $f,g\in C^3$. Wenn gilt: $\exists \lambda \in \R^n$, so dass $\nabla \lambda L(x^*, \lambda) = 0$ und $p^T \nabla_{xx}^2 L(x^*, \lambda) p > 0 \forall p \in T(x^*), p \neq 0$. Für einen regulären Punkt $x^*$, dann ist $x^*$ striktes lokales Minimum.

Beweis: Erfülle $x^*$ die hinreichende bedingung. Sei $\hat x \neq x^*$ zulässig und hinreichend nahe bei $x^*$. Betrachte die Kurve $\phi(t)$ mit $\phi(0) = x^*$, $\phi(1) = \hat x$,

\[ \phi(t) := \bpm \gamma(z(t)) \\ x^* + t(\hat z - z^*) \epm \]

so dass $g(\phi(t)) = 0$ in einer kleinen Umgebung von $x^*$

\begin{align*}
h :&= \hat z - z^*, \quad \|h\| \leq \eps_z \text{ Dann gilt } \\
\phi'(t) &= \bpm \gamma_z(z(t)) \\ I \epm h\\
\|\phi'(t)\| & \leq c_1 \|h\| \\
\phi'(0) &= \bpm \gamma_z (z^*) h \\ h \epm \in T(x^*) \leq c_1 \eps_z \\
\phi''(t) &= \bpm (\gamma_{zz} h)h \\ 0 \epm \\
\|\phi''(t)\| & \leq c_2 \|h\|^2 \leq c_2 \eps_z^2 \\
\phi'''(t) &= \bpm ((\gamma_{zzz} h)h)h \\ 0 \epm\\
\|\phi''(t)\| &\leq c_3 \|h\|^2 \leq c_3 \eps_3^3 \\
\end{align*}

Taylorentwicklung von $L(\phi(t),\lambda)$ um $t=0$:

% Da ist jetzt ein transponiert, pfffffft
% Ich weiß nicht, ob sich das wie ein Tensor transfomiert, halt 'ne dritte Ableitung

\begin{align*}
f(\hat x) - f(x^*) &= L(\hat x, \lambda) - L(x^*, \lambda) = L(\phi(t),\lambda) - L(\phi(0), \lambda) \\
&= \underbrace{\nabla_x L(\phi(0), \lambda)^T}_{=0} + \frac 12 \underbrace{ \phi'(0)^T \nabla_{xx}^2 L(\phi(0),\lambda) \phi'(0)}_{= (*) } + \frac 12 \underbrace{\nabla_x L(\phi(0), \lambda)^T}_{=0} \phi''(0) \\
&+ \frac 16 \l[ \underbrace{\phi'(\tilde t)^T ( \nabla_{xxx}^3 L(\phi(\tilde t),\lambda)^T \phi'(\tilde t)) \phi'(\tilde t)}_{\|\cdot\| \leq b \|h\|^2} + 3 \underbrace{\phi'(\tilde t)^T \nabla_{xx}^2 L(\phi(\tilde t), \lambda) \phi''(\tilde t)}_{\|\cdot\| \leq b \|h\|^3} + \underbrace{\nabla_x L(\phi(\tilde t), \lambda)^T \phi'''(\tilde t)}_{\|\cdot\| \leq b \|h\|^3} \r] \\
(*) &= h^T \bpm \gamma_z(z^*) \\ I \epm^T \nabla_{xx}^2 L(x^*, \lambda) \bpm \gamma_z(z^*) \\ I \epm h = h^T H h > 0 \\
\end{align*}

$H$ ist positiv definit und hat kleinsten Eigenwert $\lambda_{min} > 0$. Also ist $(*) \leq \lambda_{\min} \|h\|^2$,

\begin{align*}
f(\hat x) - f(x^*) & \geq \frac 12 \lambda_{min} \|h\|^2 - \frac 56 b \|h\|^3
\end{align*}

Für $\|h\| > 0$ genügend klein ist dies $>0$, also $f(\hat x) > f(x^*)$. Damit haben wir gezeigt, dass $x^*$ ein striktes lokales Minimum ist.

\msection{Satz 6.18: Stabilität}

Betrachte das gestörte Problem

\begin{align*}
&\min_x f(x, \tau) \quad (6.16) \\
&\text{s.\,t.} g(x,\tau) = 0 \\
\end{align*}

Gelten in $x^*$, $\tau = 0$ (ungestörter Lösungspunkt): Regularität, notwendige Bedingung erster Ordnung, hinreichende Bedingung zweiter Ordnung. Dann hängt die Lösung von (6.16) in einer Umgebung von $x^*$, $\tau=0$ stetig differenzierbar von $\tau$ ab. Die $x(\tau)$ sind alle strikte lokale Minima.

Beweis: Wende den Satz für implizite Funktionen auf das System $\nabla_{x,\lambda} L(x,\lambda,\tau) =: F(x,\lambda,\tau)=0$ an:

\begin{align*}
\l. \frac{\partial}{\partial (x,\lambda)} F(x,\lambda,\tau) \r|_{t=0} &= \bpm \nabla_{xx}^2 L(x^*,\lambda,0) & \nabla_x g(x^*, 0) \\ \nabla_x g(x^*, 0)^T & 0 \epm
\end{align*}

ist regulär weil $\nabla_x g(x^*, 0)$ vollen Rang hat und $\nabla_{xx}^2 L(x,\lambda,0)$ positiv definit auf $\ker \nabla_x g(x^*,0)^T$. Also hängen $x(\tau), \lambda(\tau)$ stetig differenzierbar von $\tau$ ab und sind stationäre Punkte in einer Umgebung von $\tau=0$. Die hinreichende Bedingung zweiter Ordnung gilt in einer Umgebung von $\tau=0$, also sind die $x(\tau)$ strikte lokale Minima. Die Lösung ist also stabil gegenüber kleiner Störungen der Zielfunktion und der Nebenbedingungen.

\msection{6.5 Probleme mit Ungleichungsbeschränkungen}

\msubsection{Definition 6.19}

Betrachte

\begin{align*}
\min f(x) & f \in C^2(\R^n, \R) \quad (6.18)\\
g(x)=0 & g \in C^2(\R^n, \R^{m_1}) \\
h(x) \leq 0 & h \in C^2(\R^n, \R^{m_2}) \\
\end{align*}

Die zulässige Menge von (6.18) ist $S := \{x: g(x)=0, h(x) \leq 0 \}$. Sei $J := \{1,\cdots,m_2\}$ die Indexmenge der Ungleichungen. Sei $x \in S$. Die Indexmenge der aktiven Ungleichungen ist $I(x) = \{i\in J : h_i(x) = 0\}$. Die Indexmenge der inaktiven Ungleichungen ist $I^\perp (x) = \{ i \in J: h_i(x) < 0$. $x^*$ ist regulär, wenn er die MFCQ oder die LICQ erfüllt.

\msubsection{Definition 6.20: MFCQ:}

Sei $x \in S$ zulässig und $I(x)$ die Indexmenge der in $x$ aktiven Ungleichungen. $x$ erfüllt die Mangasarian-Fromowitz-Constraint-Qualifications (MFCQ), wenn:

\bitm
\item die Gradienten $\nabla g_i(x=)$, $i=1,\cdots, m_1$ linear unabhängig sind.
\item ein Vektor $p \in \R^n$ existiert mit $\nabla g_i(x)^T p = 0$, $i=1,\cdots,m_1$ und $\nabla h_i(x)^T < 0$, $i \in I(x)$.
\eitm

\msubsection{Definition 6.21 (LICQ)}

Sei $x\in S$ Indexmenge der in $x$ aktiven Ungleichungen. $x$ erfüllt die Linear Independence Constraint Qualifications, wenn die Gradienten $\nabla g_i(x)$, $i=1,\cdots,m_1$ und $\nabla h_i$, $i \in I(x)$ linear unabhängig sind.

\msubsection{Satz 6.22}

LICQ $\RA$ MFCQ. Die Umkehrung gilt nicht. Beweis: Übungsaufgabe






